# Cargo configuration for vjson
# Optimized for maximum performance on modern CPUs

# Enable link-time optimization for release builds
[profile.release]
lto = "fat"            # Full LTO for maximum optimization (5-15% faster)
codegen-units = 1      # Single codegen unit for better optimization
opt-level = 3          # Maximum optimization
strip = true           # Strip debug symbols from binary
panic = "abort"        # Smaller binary, faster unwinding

# Profile for benchmarks (same as release but with debug info)
[profile.bench]
lto = "fat"
codegen-units = 1
opt-level = 3
debug = true

# Development profile - faster compile times
[profile.dev]
opt-level = 1          # Some optimization for reasonable dev performance
debug = true

# Target-specific optimizations
# NOTE: We use runtime SIMD detection (is_x86_feature_detected!) for portability
# AVX2/FMA are NOT required at compile time - binaries work on older CPUs

# For local development only (not portable!):
# [build]
# rustflags = ["-C", "target-cpu=native"]

# Alias for common commands
[alias]
b = "build --release"
t = "test"
c = "clippy --all-features -- -D warnings"
fmt-check = "fmt -- --check"
